(function e(t,n,r){function s(o,u){if(!n[o]){if(!t[o]){var a=typeof require=="function"&&require;if(!u&&a)return a(o,!0);if(i)return i(o,!0);var f=new Error("Cannot find module '"+o+"'");throw f.code="MODULE_NOT_FOUND",f}var l=n[o]={exports:{}};t[o][0].call(l.exports,function(e){var n=t[o][1][e];return s(n?n:e)},l,l.exports,e,t,n,r)}return n[o].exports}var i=typeof require=="function"&&require;for(var o=0;o<r.length;o++)s(r[o]);return s})({1:[function(require,module,exports){module.exports={default:require("core-js/library/fn/object/define-property"),__esModule:true}},{"core-js/library/fn/object/define-property":4}],2:[function(require,module,exports){"use strict";exports.__esModule=true;exports.default=function(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function")}}},{}],3:[function(require,module,exports){"use strict";exports.__esModule=true;var _defineProperty=require("../core-js/object/define-property");var _defineProperty2=_interopRequireDefault(_defineProperty);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}exports.default=function(){function defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||false;descriptor.configurable=true;if("value"in descriptor)descriptor.writable=true;(0,_defineProperty2.default)(target,descriptor.key,descriptor)}}return function(Constructor,protoProps,staticProps){if(protoProps)defineProperties(Constructor.prototype,protoProps);if(staticProps)defineProperties(Constructor,staticProps);return Constructor}}()},{"../core-js/object/define-property":1}],4:[function(require,module,exports){require("../../modules/es6.object.define-property");var $Object=require("../../modules/_core").Object;module.exports=function defineProperty(it,key,desc){return $Object.defineProperty(it,key,desc)}},{"../../modules/_core":7,"../../modules/es6.object.define-property":21}],5:[function(require,module,exports){module.exports=function(it){if(typeof it!="function")throw TypeError(it+" is not a function!");return it}},{}],6:[function(require,module,exports){var isObject=require("./_is-object");module.exports=function(it){if(!isObject(it))throw TypeError(it+" is not an object!");return it}},{"./_is-object":17}],7:[function(require,module,exports){var core=module.exports={version:"2.5.7"};if(typeof __e=="number")__e=core},{}],8:[function(require,module,exports){var aFunction=require("./_a-function");module.exports=function(fn,that,length){aFunction(fn);if(that===undefined)return fn;switch(length){case 1:return function(a){return fn.call(that,a)};case 2:return function(a,b){return fn.call(that,a,b)};case 3:return function(a,b,c){return fn.call(that,a,b,c)}}return function(){return fn.apply(that,arguments)}}},{"./_a-function":5}],9:[function(require,module,exports){module.exports=!require("./_fails")(function(){return Object.defineProperty({},"a",{get:function(){return 7}}).a!=7})},{"./_fails":12}],10:[function(require,module,exports){var isObject=require("./_is-object");var document=require("./_global").document;var is=isObject(document)&&isObject(document.createElement);module.exports=function(it){return is?document.createElement(it):{}}},{"./_global":13,"./_is-object":17}],11:[function(require,module,exports){var global=require("./_global");var core=require("./_core");var ctx=require("./_ctx");var hide=require("./_hide");var has=require("./_has");var PROTOTYPE="prototype";var $export=function(type,name,source){var IS_FORCED=type&$export.F;var IS_GLOBAL=type&$export.G;var IS_STATIC=type&$export.S;var IS_PROTO=type&$export.P;var IS_BIND=type&$export.B;var IS_WRAP=type&$export.W;var exports=IS_GLOBAL?core:core[name]||(core[name]={});var expProto=exports[PROTOTYPE];var target=IS_GLOBAL?global:IS_STATIC?global[name]:(global[name]||{})[PROTOTYPE];var key,own,out;if(IS_GLOBAL)source=name;for(key in source){own=!IS_FORCED&&target&&target[key]!==undefined;if(own&&has(exports,key))continue;out=own?target[key]:source[key];exports[key]=IS_GLOBAL&&typeof target[key]!="function"?source[key]:IS_BIND&&own?ctx(out,global):IS_WRAP&&target[key]==out?function(C){var F=function(a,b,c){if(this instanceof C){switch(arguments.length){case 0:return new C;case 1:return new C(a);case 2:return new C(a,b)}return new C(a,b,c)}return C.apply(this,arguments)};F[PROTOTYPE]=C[PROTOTYPE];return F}(out):IS_PROTO&&typeof out=="function"?ctx(Function.call,out):out;if(IS_PROTO){(exports.virtual||(exports.virtual={}))[key]=out;if(type&$export.R&&expProto&&!expProto[key])hide(expProto,key,out)}}};$export.F=1;$export.G=2;$export.S=4;$export.P=8;$export.B=16;$export.W=32;$export.U=64;$export.R=128;module.exports=$export},{"./_core":7,"./_ctx":8,"./_global":13,"./_has":14,"./_hide":15}],12:[function(require,module,exports){module.exports=function(exec){try{return!!exec()}catch(e){return true}}},{}],13:[function(require,module,exports){var global=module.exports=typeof window!="undefined"&&window.Math==Math?window:typeof self!="undefined"&&self.Math==Math?self:Function("return this")();if(typeof __g=="number")__g=global},{}],14:[function(require,module,exports){var hasOwnProperty={}.hasOwnProperty;module.exports=function(it,key){return hasOwnProperty.call(it,key)}},{}],15:[function(require,module,exports){var dP=require("./_object-dp");var createDesc=require("./_property-desc");module.exports=require("./_descriptors")?function(object,key,value){return dP.f(object,key,createDesc(1,value))}:function(object,key,value){object[key]=value;return object}},{"./_descriptors":9,"./_object-dp":18,"./_property-desc":19}],16:[function(require,module,exports){module.exports=!require("./_descriptors")&&!require("./_fails")(function(){return Object.defineProperty(require("./_dom-create")("div"),"a",{get:function(){return 7}}).a!=7})},{"./_descriptors":9,"./_dom-create":10,"./_fails":12}],17:[function(require,module,exports){module.exports=function(it){return typeof it==="object"?it!==null:typeof it==="function"}},{}],18:[function(require,module,exports){var anObject=require("./_an-object");var IE8_DOM_DEFINE=require("./_ie8-dom-define");var toPrimitive=require("./_to-primitive");var dP=Object.defineProperty;exports.f=require("./_descriptors")?Object.defineProperty:function defineProperty(O,P,Attributes){anObject(O);P=toPrimitive(P,true);anObject(Attributes);if(IE8_DOM_DEFINE)try{return dP(O,P,Attributes)}catch(e){}if("get"in Attributes||"set"in Attributes)throw TypeError("Accessors not supported!");if("value"in Attributes)O[P]=Attributes.value;return O}},{"./_an-object":6,"./_descriptors":9,"./_ie8-dom-define":16,"./_to-primitive":20}],19:[function(require,module,exports){module.exports=function(bitmap,value){return{enumerable:!(bitmap&1),configurable:!(bitmap&2),writable:!(bitmap&4),value:value}}},{}],20:[function(require,module,exports){var isObject=require("./_is-object");module.exports=function(it,S){if(!isObject(it))return it;var fn,val;if(S&&typeof(fn=it.toString)=="function"&&!isObject(val=fn.call(it)))return val;if(typeof(fn=it.valueOf)=="function"&&!isObject(val=fn.call(it)))return val;if(!S&&typeof(fn=it.toString)=="function"&&!isObject(val=fn.call(it)))return val;throw TypeError("Can't convert object to primitive value")}},{"./_is-object":17}],21:[function(require,module,exports){var $export=require("./_export");$export($export.S+$export.F*!require("./_descriptors"),"Object",{defineProperty:require("./_object-dp").f})},{"./_descriptors":9,"./_export":11,"./_object-dp":18}],22:[function(require,module,exports){"use strict";var _classCallCheck2=require("babel-runtime/helpers/classCallCheck");var _classCallCheck3=_interopRequireDefault(_classCallCheck2);var _createClass2=require("babel-runtime/helpers/createClass");var _createClass3=_interopRequireDefault(_createClass2);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}var Storage=require("../Storage");var notifications=require("../Notifications");var items=Storage.get("cart")||{};var Cart=function(){function Cart(){(0,_classCallCheck3.default)(this,Cart)}(0,_createClass3.default)(Cart,[{key:"add",value:function add(cartItem){var item=void 0;if(items[cartItem.id]){item=items[cartItem.id]}else{items[cartItem.id]=cartItem;item=cartItem}item.quantity++;this.save();notifications.create({type:"addToCart",item:item});return item}},{key:"save",value:function save(){Storage.set("cart",items);return true}},{key:"clear",value:function clear(){items={};this.save();return true}},{key:"remove",value:function remove(item){var newCart=Object.assign({},items);delete newCart[item.id];items=newCart;this.save();return true}},{key:"changeQuantity",value:function changeQuantity(item,qty){if(!Number.isInteger(qty)){return false}items[item.id].quantity=qty;this.save();return true}},{key:"get",value:function get(){var publicCart=JSON.parse(JSON.stringify(items));return publicCart}},{key:"getSubtotal",value:function getSubtotal(){return Object.keys(items).map(function(itemKey){var item=items[itemKey];return item.amount*item.quantity}).reduce(function(acc,cum){return cum+acc},0)}},{key:"update",value:function update(shoppableItem){var cartItem=items[shoppableItem.id];if(cartItem){for(var prop in shoppableItem){if(prop!=="quantity"){cartItem[prop]=shoppableItem[prop]}}}this.save()}}]);return Cart}();module.exports=Cart},{"../Notifications":30,"../Storage":32,"babel-runtime/helpers/classCallCheck":2,"babel-runtime/helpers/createClass":3}],23:[function(require,module,exports){"use strict";var _classCallCheck2=require("babel-runtime/helpers/classCallCheck");var _classCallCheck3=_interopRequireDefault(_classCallCheck2);var _createClass2=require("babel-runtime/helpers/createClass");var _createClass3=_interopRequireDefault(_createClass2);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}var isValid=require("./isValid.js");var CartItem=function(){function CartItem(elem){(0,_classCallCheck3.default)(this,CartItem);this.id=elem.dataset.id;this.amount=parseInt(elem.dataset.amount,10);this.name=elem.dataset.name;this.description=elem.dataset.description;this.quantity=0}(0,_createClass3.default)(CartItem,[{key:"setQuantity",value:function setQuantity(qty){this.quantity=qty}}],[{key:"validate",value:function validate(elem){return isValid(elem)}},{key:"resolveReference",value:function resolveReference(elem){var referenced=document.querySelector("[data-id="+elem.dataset.ref+"]");if(!referenced){return false}return referenced}}]);return CartItem}();module.exports=CartItem},{"./isValid.js":24,"babel-runtime/helpers/classCallCheck":2,"babel-runtime/helpers/createClass":3}],24:[function(require,module,exports){"use strict";var Logger=require("../Logger");var itemsValidated={};module.exports=function(elem){var errors=0;var id=elem.dataset.id;var ref=elem.dataset.ref;if(!id&&!ref){Logger.add("[data-id] or [data-ref] is required for a cart item element: "+elem.outerHTML);errors++}if(itemsValidated[id]&&!elem.dataset.referenced){Logger.add("ID "+id+" already used on another element. Use [data-ref] to point to another ID.  This item will be disabled: "+elem.outerHTML);errors++}if(isNaN(parseInt(elem.dataset.amount),10)){Logger.add("Invalid amount.  Amount must be in base units (cents): "+elem.outerHTML);errors++}itemsValidated[id]=true;return errors===0}},{"../Logger":29}],25:[function(require,module,exports){"use strict";var _classCallCheck2=require("babel-runtime/helpers/classCallCheck");var _classCallCheck3=_interopRequireDefault(_classCallCheck2);var _createClass2=require("babel-runtime/helpers/createClass");var _createClass3=_interopRequireDefault(_createClass2);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}var Cart=require("../Cart");var Logger=require("../Logger");var DOM=require("../DOM");var options=require("../Options");var config=require("../Config");var Cartmine=function(){function Cartmine(){var _this=this;(0,_classCallCheck3.default)(this,Cartmine);this.cart=new Cart;this.options=options;this.authToken=null;this.onCheckoutHandler=null;document.addEventListener("DOMContentLoaded",function(){_this.init()})}(0,_createClass3.default)(Cartmine,[{key:"checkout",value:function checkout(){if(this.onCheckoutHandler){this.onCheckoutHandler()}else if(!config.cartmineForm){this.submit()}else{this.submitForm()}}},{key:"onCheckout",value:function onCheckout(func){this.onCheckoutHandler=func}},{key:"submit",value:function submit(token){if(token!==undefined){this.setAuthToken(token)}var purchaseDocument=this.makePurchaseDocument();return fetch(this.options.checkoutUrl,{method:"POST",body:purchaseDocument,headers:{"Content-Type":"application/json"}})}},{key:"submitForm",value:function submitForm(){config.cartmineForm.submit()}},{key:"makePurchaseDocument",value:function makePurchaseDocument(){var cartItems=this.cart.get();var purchaseDocument={options:this.options,subtotal:this.getSubtotal(),items:Object.keys(cartItems).map(function(cartItemKey){return cartItems[cartItemKey]}),currencyCode:this.options.currency,taxRate:this.options.taxRate};if(this.authToken){purchaseDocument.authToken=this.authToken}return JSON.stringify(purchaseDocument)}},{key:"setAuthToken",value:function setAuthToken(token){this.authToken=token}},{key:"getSubtotal",value:function getSubtotal(){return this.cart.getSubtotal()}},{key:"init",value:function init(){DOM.setupItems(this);DOM.setupCheckoutButtons(this);if(options.testing){Logger.log()}}}],[{key:"start",value:function start(){if(!window.Cartmine){window.Cartmine=new Cartmine}return window.Cartmine}}]);return Cartmine}();module.exports=Cartmine},{"../Cart":22,"../Config":26,"../DOM":27,"../Logger":29,"../Options":31,"babel-runtime/helpers/classCallCheck":2,"babel-runtime/helpers/createClass":3}],26:[function(require,module,exports){"use strict";var Logger=require("../Logger");var Config=function Config(){var cartmineScript=document.querySelector("script[data-cartmine]");var cartmineScriptParent=cartmineScript.parentElement;var useForm=cartmineScriptParent.tagName==="form"&&cartmineScriptParent.action;if(!cartmineScript){Logger.add("Cartmine script was not added properly - [data-cartmine] is required")}return{cartmineScript:cartmineScript,cartmineForm:useForm?cartmineScriptParent:false}};module.exports=Config()},{"../Logger":29}],27:[function(require,module,exports){"use strict";var CartItem=require("../CartItem");var listeners=require("./listeners.js");var Logger=require("../Logger");module.exports={setupItems:function setupItems(Cartmine){if(Cartmine.options.dataMapId){this.mapDataToItems(Cartmine)}var items=[].slice.call(document.querySelectorAll("[data-cartmine-item]"));this.addItems(Cartmine,items)},addItems:function addItems(Cartmine,items){items.forEach(function(item){var reference=null;if(item.dataset.ref){reference=item;item=CartItem.resolveReference(item);if(!item){return false}item.setAttribute("data-referenced",true)}if(CartItem.validate(item)){var addableItem=new CartItem(item);Cartmine.cart.update(addableItem);listeners.add({elem:reference?reference:item,handler:function handler(){Cartmine.cart.add(addableItem)}})}})},mapDataToItems:function mapDataToItems(Cartmine){var dataMapId=Cartmine.options.dataMapId;var dataMapScript=document.getElementById(dataMapId);if(!dataMapScript){return false}var dataItems=JSON.parse(dataMapScript.innerHTML);var itemsToAdd=[];Object.keys(dataItems).forEach(function(dataItemKey){var dataItem=dataItems[dataItemKey];if(!dataItem.selector){return false}var dataItemElems=[].slice.call(document.querySelectorAll(dataItem.selector));if(dataItemElems.length===0){Logger.add("The data map selector "+dataItem.selector+" did not resolve to any HTML element on this page","info")}dataItemElems.forEach(function(elem){elem.setAttribute("data-id",dataItemKey);Object.keys(dataItem).forEach(function(dataItemPropKey){elem.setAttribute("data-"+dataItemPropKey,dataItem[dataItemPropKey])});itemsToAdd.push(elem)})});this.addItems(Cartmine,itemsToAdd)},setupCheckoutButtons:function setupCheckoutButtons(Cartmine){var checkoutButtons=[].slice.call(document.querySelectorAll("[data-cartmine-checkout]"));checkoutButtons.forEach(function(button){listeners.add({elem:button,handler:function handler(){Cartmine.checkout()}})})}}},{"../CartItem":23,"../Logger":29,"./listeners.js":28}],28:[function(require,module,exports){"use strict";module.exports={add:function add(_ref){var elem=_ref.elem,handler=_ref.handler,_ref$listeners=_ref.listeners,listeners=_ref$listeners===undefined?["click"]:_ref$listeners;listeners.forEach(function(listener){elem.addEventListener(listener,handler)})}}},{}],29:[function(require,module,exports){"use strict";var _classCallCheck2=require("babel-runtime/helpers/classCallCheck");var _classCallCheck3=_interopRequireDefault(_classCallCheck2);var _createClass2=require("babel-runtime/helpers/createClass");var _createClass3=_interopRequireDefault(_createClass2);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}var Logger=function(){function Logger(){(0,_classCallCheck3.default)(this,Logger);this.errors=[];this.warns=[];this.infos=[]}(0,_createClass3.default)(Logger,[{key:"add",value:function add(message){var level=arguments.length>1&&arguments[1]!==undefined?arguments[1]:"error";switch(level){case"error":this.errors.push(message);break;case"warn":this.warns.push(message);break;case"info":this.infos.push(message);break}}},{key:"get",value:function get(){return{errors:this.errors,warns:this.warms,infos:this.infos}}},{key:"log",value:function log(){console.log("%c Cartmine Report ","background: #222; color: #bada55; font-size: 18px; padding: 12px;");console.log("%c Errors ("+this.errors.length+"): ","color: red",""+(this.errors.length>0?"\r\n":""),this.errors.join("\r\n "));console.log("%c Warnings ("+this.warns.length+"): ","color: orange",""+(this.warns.length>0?"\r\n":""),this.warns.join("\r\n "));console.log("%c Infos ("+this.infos.length+"): ","color: blue",""+(this.infos.length>0?"\r\n":""),this.infos.join("\r\n "))}}]);return Logger}();module.exports=new Logger},{"babel-runtime/helpers/classCallCheck":2,"babel-runtime/helpers/createClass":3}],30:[function(require,module,exports){"use strict";var _classCallCheck2=require("babel-runtime/helpers/classCallCheck");var _classCallCheck3=_interopRequireDefault(_classCallCheck2);var _createClass2=require("babel-runtime/helpers/createClass");var _createClass3=_interopRequireDefault(_createClass2);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}var Notifications=function(){function Notifications(){(0,_classCallCheck3.default)(this,Notifications)}(0,_createClass3.default)(Notifications,[{key:"create",value:function create(_ref){var type=_ref.type,item=_ref.item;switch(type){case"addToCart":this.addToCart(item);break}}},{key:"addToCart",value:function addToCart(item){var notificationString=item.quantity+" "+(item.name||"")+" Added to Cart!";this.show(notificationString)}},{key:"show",value:function show(string){console.log(string)}}]);return Notifications}();module.exports=new Notifications},{"babel-runtime/helpers/classCallCheck":2,"babel-runtime/helpers/createClass":3}],31:[function(require,module,exports){"use strict";var cartmineScript=document.querySelector("script[data-cartmine]");var options={currencyCode:cartmineScript.getAttribute("data-currency")||"USD",testing:cartmineScript.getAttribute("data-testing")==="true",checkoutUrl:cartmineScript.getAttribute("data-checkout-url")||"?",taxRate:cartmineScript.getAttribute("data-tax-rate")||null,dataMapId:cartmineScript.getAttribute("data-items-map-id")||null};module.exports=options},{}],32:[function(require,module,exports){"use strict";var _classCallCheck2=require("babel-runtime/helpers/classCallCheck");var _classCallCheck3=_interopRequireDefault(_classCallCheck2);var _createClass2=require("babel-runtime/helpers/createClass");var _createClass3=_interopRequireDefault(_createClass2);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}var Storage=function(){function Storage(){(0,_classCallCheck3.default)(this,Storage);this.supportsLocalStore=this.doesSupportLocalStore()}(0,_createClass3.default)(Storage,[{key:"doesSupportLocalStore",value:function doesSupportLocalStore(){try{localStorage.setItem("test",true);localStorage.removeItem("test");return true}catch(err){return false}}},{key:"set",value:function set(item,value){var jsonValue=JSON.stringify(value);if(this.supportsLocalStore){window.localStorage.setItem(item,jsonValue)}else{Cookies.set(item,jsonValue)}return true}},{key:"get",value:function get(item){var value=void 0;if(this.supportsLocalStore){value=window.localStorage.getItem(item)}else{value=Cookies.get(item)||null}return JSON.parse(value)}}]);return Storage}();module.exports=new Storage},{"babel-runtime/helpers/classCallCheck":2,"babel-runtime/helpers/createClass":3}],33:[function(require,module,exports){"use strict";var Cartmine=require("./Cartmine");Cartmine.start()},{"./Cartmine":25}]},{},[33]);
